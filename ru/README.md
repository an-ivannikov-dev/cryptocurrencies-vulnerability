# Уязвимость криптовалют

## Криптография
До появления квантовых компьютеров не следует опасаться уязвимости криптографии.

### Brain Wallet
Придуман и сломан уже много лет назад

Фраза (тестовая строка) хэшируется из нее получают приватный ключ.
- возможны разные языки тестовой строки;
- возможно применение не строчных символов а хаотичного набора байт (исключает разные языки);
- возможно многократное хэширование;

**Конечный результат как 64 битное число из которого делается приватный ключ**

```bash
priv_key = SHA256(passphrase)
```

### HD Wallet (Mnemonic)

```js
const phrase = 'nurse brick alarm novel soldier camera service gentle tank talent magnet unique';
```

- Фраза из нескольких слов
- Каждое слово из словаря (wordlist) размером 2048 (есть стандартные наборы для разных языков)
- возможно применение не стандартных наборов слов или любых других фраз
- возмножно применение байтового набора
- разное количество итераций
- другая соль

**Конечный результат как 64 битное число из которого делается приватный ключ**
**На основе этого ключа строится HD Wallet с множеством ключей**

```js
//https://www.npmjs.com/package/unorm
const unorm = require('unorm');
const crypto = require("crypto");

const = passphrase = passphrase || '';
// pbkdf2(key, salt, iterations, dkLen)
const seed = pbkdf2(unorm.nfkd(phrase), unorm.nfkd('mnemonic' + passphrase), 2048, 64);
```


## Материалы
[bip-0039](https://github.com/bitcoin/bips/blob/master/bip-0039.mediawiki)
[bitcore-mnemonic]https://github.com/bitpay/bitcore/blob/master/packages/bitcore-mnemonic/docs/index.md
[on reddit](https://www.reddit.com/r/Bitcoin/comments/1zti1p/17956_hacked_brainwallet_passwords/)
[allprivatekeys.com](https://allprivatekeys.com/hacked-brainwallets-with-balance)
